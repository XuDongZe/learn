# OSI七层模型
OSI, Open System Interconnect. 开放式系统互联协议. 作用是屏蔽不同网络类型之间的差异.
# 物理层

# 数据链路层
## 主要任务
1. 数据帧
    * 物理层的数据格式是比特, 如果想要表达复杂的含义, 则必然需要对比特进行逻辑分组. 链路层的基本数据格式是帧. 从比特到帧 是链路层的首要任务.
2. 传输机制 
    * 物理层的传输是点对点传输, 需要两个设备之间具有物理连接. 链路层拓展了传输机制, 除了点对点, 还支持以mac地址寻址为基础的链路层广播和多播协议.
3. 差错控制
    * 物理层传输会由于物理设备的原因, 不可避免的产生差错. 差错的常见来源有噪声和设备故障等. 链路层通过纠错码和检查码+重传, 实现了差错控制.

## 差错控制
假设A B之间建立链路连接. A为发送端, B为接收端.

### 超时重传 数据帧副本
在帧发送之后, 立即启动一个计时器. 在计时器超时之前没有收到接收端的ack, 则认为该帧传输失败. 由于存在帧丢失和ack丢失的情况, 所以在发送方和接收方实际上网络状态隔离的情况下, 重传机制依然可以工作. 也就是说重传机制不能仅仅依赖于对端的服务. 所以本地重传机制是一个必须的选择, 超时是一个简单有效的策略.

发送端在发送每一个帧之前, 将该帧备份一份副本. 这个副本将被用来该帧需要重传时. 因为我们在某个帧发送时无法知道该帧是否需要重传, 所以备份是一个必须的选择.

### 确认
首先来看一下确认机制. 显然发送方不能盲目的发送数据帧而不管接收方是否成功接收. 想想如果这样的话, 那么我们的数据链路层将会充斥大量无效的数据帧. 所以应该有一个确认机制, 使得发送端可以知道自己发送的某个帧已经被成功接收. 从而自己可以去发送后面的帧. 也就是ack机制.

ack有两种, 肯定ack和否定ack. 肯定ack表示正常接收, 发送方可以继续发送后续的帧. 否定ack用于检查出数据帧损坏后的快速响应, 如果我们没有否定ack, 那么此种情况我们只能依赖于发送方的超时重发.

### 丢弃 | 缓存
数据帧的重发导致发送方的帧的发送顺序是乱序, 重复的. 所以接收方必须具有处理重复的, 乱序的数据帧的能力. 通常的策略有两种:
1. 丢弃
    * 接收端一直等待当前序号的帧. 乱序的帧(该帧需要与接收端的当前期望值不同)直接被丢弃, 接收端将不处理这个帧.

我们可能遇到的错误情况有
1. 帧丢失
    * 发送方的帧丢失. 接收端自然接收不到, ack也自然不会发出.
    * 发送方: 超时重传.
    * 接收方: 可以
2. ack丢失
    * 接收方对于某个帧的ack丢失. 无论这个ack是肯定还是否定的. 发送方自然无法


发送端判定帧传输失败后的总体策略是, 重新传输这个帧. 当然这里的判定失败-重传机制有几种不同的策略: 停-等协议, 滑动窗口-后退N步(GBN), 滑动窗口-选择重传(SR).

